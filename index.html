<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spectra Artifacts</title>

    <script>
        async function listDir(path) {
            const url = `https://api.github.com/repos/JTechGaming/SpectraArtifacts/contents/${path}?t=${Date.now()}`;
        
            const res = await fetch(url);
            if (!res.ok) {
                console.error("Failed to fetch:", url);
                return [];
            }
        
            return await res.json();
        }

        async function loadArtifacts() {
            const root = document.getElementById("content");
            if (!root) {
                console.error("Container #content not found!");
                return;
            }

            const groups = await listDir("org");

            for (const group of groups) {
                if (group.type !== "dir") continue;

                const groupDiv = document.createElement("div");
                groupDiv.innerHTML = `<h2>${group.name}</h2>`;
                root.appendChild(groupDiv);

                const packages = await listDir(`org/${group.name}`);

                for (const pkg of packages) {
                    if (pkg.type !== "dir") continue;

                    const pkgDiv = document.createElement("div");
                    pkgDiv.style.marginLeft = "20px";
                    pkgDiv.innerHTML = `<h3>${pkg.name}</h3>`;
                    root.appendChild(pkgDiv);

                    const versions = await listDir(`org/${group.name}/${pkg.name}`);

                    for (const ver of versions) {
                        if (ver.type !== "dir") continue;

                        const verDiv = document.createElement("div");
                        verDiv.style.marginLeft = "40px";

                        const link = document.createElement("a");
                        link.href = `./org/${group.name}/${pkg.name}/${ver.name}/`;
                        link.innerText = ver.name;

                        verDiv.appendChild(link);
                        root.appendChild(verDiv);
                    }
                }
            }
        }

        document.addEventListener("DOMContentLoaded", loadArtifacts);
    </script>
</head>
<body>
    <h1>Spectra Artifacts Repository</h1>
    <div id="content"></div>
</body>
</html>
